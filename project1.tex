% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={project1},
  pdfauthor={yan},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{project1}
\author{yan}
\date{2023-09-09}

\begin{document}
\maketitle

\hypertarget{part-1-explore-data}{%
\subsection{Part 1: Explore data}\label{part-1-explore-data}}

\hypertarget{section}{%
\subsubsection{1}\label{section}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{qplot}\NormalTok{(rating, }\AttributeTok{data =}\NormalTok{ chocolate)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\includegraphics{project1_files/figure-latex/unnamed-chunk-1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{bins =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-1-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{bins =} \DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-1-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{bins =} \DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-1-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{bins =} \DecValTok{25}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-1-5.pdf}
\#\#\# 2

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{counties }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(chocolate, country\_of\_bean\_origin)}
\FunctionTok{summarise}\NormalTok{(counties)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 62 x 1
##    country_of_bean_origin
##    <chr>                 
##  1 Australia             
##  2 Belize                
##  3 Blend                 
##  4 Bolivia               
##  5 Brazil                
##  6 Burma                 
##  7 Cameroon              
##  8 China                 
##  9 Colombia              
## 10 Congo                 
## # i 52 more rows
\end{verbatim}

\hypertarget{section-1}{%
\subsubsection{3}\label{section-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ecuador }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(chocolate, country\_of\_bean\_origin }\SpecialCharTok{==} \StringTok{"Ecuador"}\NormalTok{)}
\FunctionTok{summarise}\NormalTok{(ecuador, }\AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(rating), }\AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(rating), }\AttributeTok{total =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 3
##    mean    sd total
##   <dbl> <dbl> <int>
## 1  3.16 0.512   219
\end{verbatim}

\hypertarget{section-2}{%
\subsubsection{4}\label{section-2}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ecuadors }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(ecuador, company\_location)}
\FunctionTok{summarise}\NormalTok{(ecuadors, }\AttributeTok{quality =} \FunctionTok{mean}\NormalTok{(rating))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 25 x 2
##    company_location quality
##    <chr>              <dbl>
##  1 Argentina           3.25
##  2 Australia           3.81
##  3 Austria             2.88
##  4 Belgium             3.05
##  5 Canada              3.28
##  6 Denmark             2.5 
##  7 Ecuador             3.00
##  8 France              3.19
##  9 Germany             2.44
## 10 Hungary             3.5 
## # i 15 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ecuadorss }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{summarise}\NormalTok{(ecuadors, }\AttributeTok{quality =} \FunctionTok{mean}\NormalTok{(rating)))}
\FunctionTok{arrange}\NormalTok{(ecuadorss, }\FunctionTok{desc}\NormalTok{(quality))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    company_location quality
## 1         Australia    3.81
## 2       Switzerland    3.75
## 3       New Zealand    3.62
## 4           Hungary    3.50
## 5            Israel    3.50
## 6       Netherlands    3.50
## 7         Singapore    3.50
## 8       South Korea    3.33
## 9            Canada    3.28
## 10           U.S.A.    3.26
## 11        Argentina    3.25
## 12        Nicaragua    3.25
## 13           Poland    3.25
## 14           Russia    3.25
## 15           France    3.19
## 16            Italy    3.19
## 17             U.K.    3.08
## 18          Belgium    3.05
## 19          Ecuador    3.00
## 20            Spain    2.94
## 21          Austria    2.88
## 22          Denmark    2.50
## 23         Scotland    2.50
## 24     South Africa    2.50
## 25          Germany    2.44
\end{verbatim}

\hypertarget{section-3}{%
\subsubsection{5}\label{section-3}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country\_rate }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(chocolate, country\_of\_bean\_origin)}
\FunctionTok{summarise}\NormalTok{(country\_rate, }\AttributeTok{rates =} \FunctionTok{mean}\NormalTok{ (rating))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 62 x 2
##    country_of_bean_origin rates
##    <chr>                  <dbl>
##  1 Australia               3.25
##  2 Belize                  3.23
##  3 Blend                   3.04
##  4 Bolivia                 3.18
##  5 Brazil                  3.26
##  6 Burma                   3   
##  7 Cameroon                3.08
##  8 China                   3.5 
##  9 Colombia                3.20
## 10 Congo                   3.32
## # i 52 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country\_rates }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{summarise}\NormalTok{(country\_rate, }\AttributeTok{rates =} \FunctionTok{mean}\NormalTok{ (rating)))}
\FunctionTok{arrange}\NormalTok{(country\_rates, }\FunctionTok{desc}\NormalTok{(rates))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    country_of_bean_origin rates
## 1                  Tobago  3.62
## 2                   China  3.50
## 3     Sao Tome & Principe  3.50
## 4         Solomon Islands  3.45
## 5                   Congo  3.32
## 6                Thailand  3.30
## 7                    Cuba  3.29
## 8                 Vietnam  3.29
## 9        Papua New Guinea  3.28
## 10             Madagascar  3.27
## 11                  Haiti  3.27
## 12                 Brazil  3.26
## 13              Guatemala  3.26
## 14              Nicaragua  3.25
## 15              Australia  3.25
## 16                  Gabon  3.25
## 17               Sulawesi  3.25
## 18               Suriname  3.25
## 19               Trinidad  3.24
## 20                 U.S.A.  3.24
## 21               Honduras  3.24
## 22               Tanzania  3.23
## 23                 Belize  3.23
## 24              Venezuela  3.23
## 25     Dominican Republic  3.22
## 26                Jamaica  3.20
## 27                   Peru  3.20
## 28               Colombia  3.20
## 29                Bolivia  3.18
## 30                 Mexico  3.17
## 31                Ecuador  3.16
## 32                  India  3.16
## 33             Costa Rica  3.15
## 34                  Ghana  3.13
## 35            Philippines  3.12
## 36                Vanuatu  3.12
## 37              Indonesia  3.11
## 38                 Panama  3.11
## 39               Malaysia  3.09
## 40               Cameroon  3.08
## 41                Liberia  3.08
## 42                  Samoa  3.08
## 43                   Togo  3.08
## 44               Sao Tome  3.07
## 45                 Uganda  3.07
## 46                   Fiji  3.06
## 47                  Blend  3.04
## 48                Grenada  3.03
## 49                  Burma  3.00
## 50               DR Congo  3.00
## 51            El Salvador  3.00
## 52                Nigeria  3.00
## 53                Sumatra  3.00
## 54              St. Lucia  2.95
## 55              Sri Lanka  2.88
## 56                 Taiwan  2.88
## 57            Ivory Coast  2.86
## 58             Martinique  2.75
## 59               Principe  2.75
## 60           Sierra Leone  2.75
## 61  St.Vincent-Grenadines  2.75
## 62            Puerto Rico  2.71
\end{verbatim}

\hypertarget{section-4}{%
\subsubsection{6}\label{section-4}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country\_rate }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(chocolate, country\_of\_bean\_origin)}
\NormalTok{country\_rate1 }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(country\_rate, }\AttributeTok{n =} \FunctionTok{n}\NormalTok{())}
\NormalTok{country\_rate2 }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(country\_rate1, n }\SpecialCharTok{\textgreater{}=} \DecValTok{10}\NormalTok{)}
\FunctionTok{summarise}\NormalTok{(country\_rate2, }\FunctionTok{mean}\NormalTok{(rating))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 35 x 2
##    country_of_bean_origin `mean(rating)`
##    <chr>                           <dbl>
##  1 Belize                           3.23
##  2 Blend                            3.04
##  3 Bolivia                          3.18
##  4 Brazil                           3.26
##  5 Colombia                         3.20
##  6 Congo                            3.32
##  7 Costa Rica                       3.15
##  8 Cuba                             3.29
##  9 Dominican Republic               3.22
## 10 Ecuador                          3.16
## # i 25 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country\_rate3 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{summarise}\NormalTok{(country\_rate2, }\AttributeTok{rates3 =} \FunctionTok{mean}\NormalTok{(rating)))}
\FunctionTok{arrange}\NormalTok{(country\_rate3, }\FunctionTok{desc}\NormalTok{(rates3))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    country_of_bean_origin rates3
## 1         Solomon Islands   3.45
## 2                   Congo   3.32
## 3                    Cuba   3.29
## 4                 Vietnam   3.29
## 5        Papua New Guinea   3.28
## 6              Madagascar   3.27
## 7                   Haiti   3.27
## 8                  Brazil   3.26
## 9               Guatemala   3.26
## 10              Nicaragua   3.25
## 11               Trinidad   3.24
## 12                 U.S.A.   3.24
## 13               Honduras   3.24
## 14               Tanzania   3.23
## 15                 Belize   3.23
## 16              Venezuela   3.23
## 17     Dominican Republic   3.22
## 18                Jamaica   3.20
## 19                   Peru   3.20
## 20               Colombia   3.20
## 21                Bolivia   3.18
## 22                 Mexico   3.17
## 23                Ecuador   3.16
## 24                  India   3.16
## 25             Costa Rica   3.15
## 26                  Ghana   3.13
## 27            Philippines   3.12
## 28                Vanuatu   3.12
## 29              Indonesia   3.11
## 30               Sao Tome   3.07
## 31                 Uganda   3.07
## 32                   Fiji   3.06
## 33                  Blend   3.04
## 34                Grenada   3.03
## 35              St. Lucia   2.95
\end{verbatim}

\hypertarget{section-5}{%
\subsubsection{7}\label{section-5}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country\_rate4 }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(country\_rate1, n }\SpecialCharTok{\textgreater{}=} \DecValTok{50}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\hypertarget{part-2-join-two-datasets-together}{%
\subsection{Part 2: Join two datasets
together}\label{part-2-join-two-datasets-together}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gapminder)}
\FunctionTok{library}\NormalTok{(dplyr)}
\NormalTok{newdata }\OtherTok{\textless{}{-}}\NormalTok{ gapminder}
\NormalTok{newdata1 }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(newdata, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\NormalTok{newdata2 }\OtherTok{\textless{}{-}} \FunctionTok{rename}\NormalTok{(newdata1, }\AttributeTok{country\_of\_bean\_origin =}\NormalTok{ country)}
\NormalTok{chocolate1 }\OtherTok{\textless{}{-}} \FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ chocolate, }\AttributeTok{y =}\NormalTok{ newdata2, }\AttributeTok{by =} \StringTok{"country\_of\_bean\_origin"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in left_join(x = chocolate, y = newdata2, by = "country_of_bean_origin"): Detected an unexpected many-to-many relationship between `x` and `y`.
## i Row 1 of `x` matches multiple rows in `y`.
## i Row 913 of `y` matches multiple rows in `x`.
## i If a many-to-many relationship is expected, set `relationship = "many-to-many"` to silence this warning.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chocolate2 }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(chocolate1, country\_of\_bean\_origin)}
\NormalTok{chocolate3 }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(chocolate2, }\AttributeTok{reviews =} \FunctionTok{n}\NormalTok{())}
\NormalTok{chocolate4 }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(chocolate3, reviews }\SpecialCharTok{\textgreater{}=} \DecValTok{10}\NormalTok{)}
\NormalTok{chocolate5 }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(chocolate4, country\_of\_bean\_origin}\SpecialCharTok{!=}\StringTok{"Blend"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{ggplot}\NormalTok{(chocolate5, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ continent, }\AttributeTok{y =}\NormalTok{ rating)) }\SpecialCharTok{+} \FunctionTok{geom\_violin}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=} \StringTok{"continents"}\NormalTok{, }\AttributeTok{y =} \StringTok{"ratings"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-8-1.pdf}

\hypertarget{part-3-convert-wide-data-into-long-data}{%
\subsection{Part 3: Convert wide data into long
data}\label{part-3-convert-wide-data-into-long-data}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(tidyr)}
\NormalTok{newchocolate }\OtherTok{\textless{}{-}}\NormalTok{ chocolate }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{beans =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{"B"}\NormalTok{, ingredients) }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sugar =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{"S"}\NormalTok{, ingredients) }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{cocoa\_butter =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{"C"}\NormalTok{, ingredients) }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{vanilla =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{"V"}\NormalTok{, ingredients) }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{letchin =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{"L"}\NormalTok{, ingredients) }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{salt =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{"S"}\NormalTok{, ingredients) }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\DecValTok{0}\NormalTok{))}
\FunctionTok{library}\NormalTok{(stringr)}
\NormalTok{newchocolate1 }\OtherTok{\textless{}{-}}\NormalTok{ newchocolate }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{char\_cocoa =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(most\_memorable\_characteristics, }\StringTok{"cocoa"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{char\_sweet =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(most\_memorable\_characteristics, }\StringTok{"sweet"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{char\_nutty =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(most\_memorable\_characteristics, }\StringTok{"nutty"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{char\_creamy =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(most\_memorable\_characteristics, }\StringTok{"creamy"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{char\_roasty =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(most\_memorable\_characteristics, }\StringTok{"roasty"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{char\_earthy =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(most\_memorable\_characteristics, }\StringTok{"earthy"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\DecValTok{1}\NormalTok{, }\ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \DecValTok{0}\NormalTok{))}

\NormalTok{newchocolate2 }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(newchocolate1, review\_date)}
\FunctionTok{summarise}\NormalTok{(newchocolate2, }\AttributeTok{beansm =} \FunctionTok{mean}\NormalTok{(beans), }\AttributeTok{sugarm =} \FunctionTok{mean}\NormalTok{(sugar), }\AttributeTok{cocoa\_butterm =}\NormalTok{ (cocoa\_butter), }\AttributeTok{vanillam =} \FunctionTok{mean}\NormalTok{(vanilla), }\AttributeTok{letchinm =} \FunctionTok{mean}\NormalTok{(letchin), }\AttributeTok{saltm =} \FunctionTok{mean}\NormalTok{(salt), }\AttributeTok{char\_cocoam =} \FunctionTok{mean}\NormalTok{(char\_cocoa), }\AttributeTok{char\_sweetm =} \FunctionTok{mean}\NormalTok{(char\_sweet), }\AttributeTok{char\_nuttym =} \FunctionTok{mean}\NormalTok{(char\_nutty), }\AttributeTok{char\_creamym =} \FunctionTok{mean}\NormalTok{(char\_creamy), }\AttributeTok{char\_roastym =} \FunctionTok{mean}\NormalTok{(char\_roasty), }\AttributeTok{char\_earthym =} \FunctionTok{mean}\NormalTok{(char\_earthy))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in dplyr 1.1.0.
## i Please use `reframe()` instead.
## i When switching from `summarise()` to `reframe()`, remember that `reframe()` always returns an ungrouped data
##   frame and adjust accordingly.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.
\end{verbatim}

\begin{verbatim}
## `summarise()` has grouped output by 'review_date'. You can override using the `.groups` argument.
\end{verbatim}

\begin{verbatim}
## # A tibble: 2,530 x 13
## # Groups:   review_date [16]
##    review_date beansm sugarm cocoa_butterm vanillam letchinm saltm char_cocoam char_sweetm char_nuttym
##          <dbl>  <dbl>  <dbl>         <dbl>    <dbl>    <dbl> <dbl>       <dbl>       <dbl>       <dbl>
##  1        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  2        2006  0.968  0.968             0    0.694    0.694 0.968       0.210       0.161      0.0323
##  3        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  4        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  5        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  6        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  7        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  8        2006  0.968  0.968             1    0.694    0.694 0.968       0.210       0.161      0.0323
##  9        2006  0.968  0.968             0    0.694    0.694 0.968       0.210       0.161      0.0323
## 10        2006  0.968  0.968             0    0.694    0.694 0.968       0.210       0.161      0.0323
## # i 2,520 more rows
## # i 3 more variables: char_creamym <dbl>, char_roastym <dbl>, char_earthym <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{newchocolate3 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{summarise}\NormalTok{(newchocolate2, }\AttributeTok{beansm =} \FunctionTok{mean}\NormalTok{(beans), }\AttributeTok{sugarm =} \FunctionTok{mean}\NormalTok{(sugar), }\AttributeTok{cocoa\_butterm =}\NormalTok{ (cocoa\_butter), }\AttributeTok{vanillam =} \FunctionTok{mean}\NormalTok{(vanilla), }\AttributeTok{letchinm =} \FunctionTok{mean}\NormalTok{(letchin), }\AttributeTok{saltm =} \FunctionTok{mean}\NormalTok{(salt), }\AttributeTok{char\_cocoam =} \FunctionTok{mean}\NormalTok{(char\_cocoa), }\AttributeTok{char\_sweetm =} \FunctionTok{mean}\NormalTok{(char\_sweet), }\AttributeTok{char\_nuttym =} \FunctionTok{mean}\NormalTok{(char\_nutty), }\AttributeTok{char\_creamym =} \FunctionTok{mean}\NormalTok{(char\_creamy), }\AttributeTok{char\_roastym =} \FunctionTok{mean}\NormalTok{(char\_roasty), }\AttributeTok{char\_earthym =} \FunctionTok{mean}\NormalTok{(char\_earthy)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in dplyr 1.1.0.
## i Please use `reframe()` instead.
## i When switching from `summarise()` to `reframe()`, remember that `reframe()` always returns an ungrouped data
##   frame and adjust accordingly.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.
\end{verbatim}

\begin{verbatim}
## `summarise()` has grouped output by 'review_date'. You can override using the `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glimpse}\NormalTok{(newchocolate3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 2,530
## Columns: 13
## $ review_date   <dbl> 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, ~
## $ beansm        <dbl> 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968,~
## $ sugarm        <dbl> 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968,~
## $ cocoa_butterm <dbl> 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~
## $ vanillam      <dbl> 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694,~
## $ letchinm      <dbl> 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694, 0.694,~
## $ saltm         <dbl> 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968, 0.968,~
## $ char_cocoam   <dbl> 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, 0.21, ~
## $ char_sweetm   <dbl> 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161, 0.161,~
## $ char_nuttym   <dbl> 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.0323, 0.~
## $ char_creamym  <dbl> 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242, 0.242,~
## $ char_roastym  <dbl> 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.0484, 0.~
## $ char_earthym  <dbl> 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.0645, 0.~
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{newchocolate3 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{review\_date, }\AttributeTok{names\_to =} \StringTok{"feature"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"mean\_score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 30,360 x 3
##    review_date feature       mean_score
##          <dbl> <chr>              <dbl>
##  1        2006 beansm            0.968 
##  2        2006 sugarm            0.968 
##  3        2006 cocoa_butterm     1     
##  4        2006 vanillam          0.694 
##  5        2006 letchinm          0.694 
##  6        2006 saltm             0.968 
##  7        2006 char_cocoam       0.210 
##  8        2006 char_sweetm       0.161 
##  9        2006 char_nuttym       0.0323
## 10        2006 char_creamym      0.242 
## # i 30,350 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{newchocolate4 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(newchocolate3 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{review\_date, }\AttributeTok{names\_to =} \StringTok{"feature"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"mean\_score"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{part-4-data-visualization}{%
\subsubsection{Part 4: Data
visualization}\label{part-4-data-visualization}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{ggplot}\NormalTok{(newchocolate4, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ review\_date, }\AttributeTok{y =}\NormalTok{ mean\_score, }\AttributeTok{color =}\NormalTok{ feature)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"loess"}\NormalTok{, }\AttributeTok{formula =} \StringTok{"y\textasciitilde{}x"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mean Scores Trends Over Time"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"Letchinm and vanillam decreased over time, others kept normal"}\NormalTok{, }\AttributeTok{caption =} \StringTok{"Yan Wang"}\NormalTok{, }\AttributeTok{x=} \StringTok{"Review date"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Mean score"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"\#FFEBCD"}\NormalTok{), }\AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"white"}\NormalTok{), }\AttributeTok{panel.grid.major =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"\#FFFAF0"}\NormalTok{), }\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}\AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{11}\NormalTok{, }\AttributeTok{face =} \StringTok{"italic"}\NormalTok{)) }
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-10-1.pdf}

\hypertarget{part-5-make-the-worst-plot-you-can}{%
\subsubsection{Part 5: Make the worst plot you
can!}\label{part-5-make-the-worst-plot-you-can}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chocolate }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.factor}\NormalTok{(country\_of\_bean\_origin), }\AttributeTok{y =}\NormalTok{ rating))}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chocolate }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.factor}\NormalTok{(country\_of\_bean\_origin), }\AttributeTok{y =}\NormalTok{ rating)) }\SpecialCharTok{+} \FunctionTok{geom\_violin}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
## Groups with fewer than two data points have been dropped.
\end{verbatim}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chocolate }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.factor}\NormalTok{(country\_of\_bean\_origin), }\AttributeTok{y =}\NormalTok{ cocoa\_percent))}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{fill =}\NormalTok{ country\_of\_bean\_origin, }\AttributeTok{binwidth =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(review\_date, cocoa\_percent, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{color =}\NormalTok{ country\_of\_bean\_origin)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(review\_date, rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{geom =} \FunctionTok{c}\NormalTok{(}\StringTok{"smooth"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'
\end{verbatim}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qplot}\NormalTok{(country\_of\_bean\_origin, rating, }\AttributeTok{data =}\NormalTok{ chocolate, }\AttributeTok{geom =} \StringTok{"boxplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{project1_files/figure-latex/unnamed-chunk-11-7.pdf}

\hypertarget{part-6-make-my-plot-a-better-plot}{%
\subsubsection{Part 6: Make my plot a better
plot!}\label{part-6-make-my-plot-a-better-plot}}

\hypertarget{including-plots}{%
\subsection{Including Plots}\label{including-plots}}

You can also embed plots, for example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OtherTok{=}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_csv}\NormalTok{(}\StringTok{\textquotesingle{}https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022{-}01{-}18/chocolate.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 2530 Columns: 10
## -- Column specification ------------------------------------------------------------------------------------------
## Delimiter: ","
## chr (7): company_manufacturer, company_location, country_of_bean_origin, specific_bean_origin_or_bar_name, coc...
## dbl (3): ref, review_date, rating
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\end{document}
